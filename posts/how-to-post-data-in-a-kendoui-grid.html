


<!DOCTYPE html>
<html lang="en">
	<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=Edge"/>

	<title>Dave Glick - How to Post Data (Including Checkboxes) in a KendoUI Grid back to an ASP.NET MVC Action</title>
        <meta name="description" content="The personal blog of Dave Glick" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">        

        <link type="application/rss+xml" rel="alternate" title="Dave Glick" href="/feed.rss" />
        <link type="application/atom+xml" rel="alternate" title="Dave Glick" href="/feed.atom" />
        <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/favicon.ico" type="image/x-icon">
        <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16" />

        <link href="/Content/bootstrap/bootstrap.css" rel="stylesheet" />
        <link href="/Content/prettify.css" rel="stylesheet">
        <link href="/Content/github.css" rel="stylesheet">
        <link href="/Content/master.css" rel="stylesheet" />

        <meta name="application-name" content="Dave Glick" />
        <meta name="msapplication-tooltip" content="Dave Glick" />
        <meta name="msapplication-starturl" content="/" />

        <meta property="og:title" content="Dave Glick - How to Post Data (Including Checkboxes) in a KendoUI Grid back to an ASP.NET MVC Action" />
        
        <meta property="og:type" content="website" />
        <meta property="og:url" content="http://daveaglick.com/posts/how-to-post-data-in-a-kendoui-grid" />
        <!-- TODO: More social graph meta tags -->

        <script src="/Scripts/jquery-2.1.1.min.js"></script>
        <script src="/Scripts/bootstrap.min.js"></script>     
        <script src="/Scripts/prettify.js"></script>
        <script src="http://d3js.org/d3.v3.min.js"></script>
        <script src="/Scripts/trianglify.min.js"></script>
        <script src="/Scripts/Please-compressed.js"></script>
        <script src="//ajax.googleapis.com/ajax/libs/webfont/1.4.7/webfont.js"></script>
        <script>
            WebFont.load({
                google: {
                    families: ['Lato:400,900:latin', 'Droid+Serif::latin']
                },
                custom: {
                    families: ['daveaglick'],
                    urls: ['https://fontastic.s3.amazonaws.com/gfxCC547kHqmQZtxrW5KFY/icons.css']
                }
            });
        </script>
	</head>
	<body onload="prettyPrint()">

<div id="page-wrapper">
 <div class="container topnav container-sm-height">
  <div class="row nav-row row-sm-height">
   <div class="col-xs-3 col-sm-6 logo-col col-sm-height col-bottom">                        <a href="/">Dave Glick</a>
</div>
   <div class="col-xs-9 visible-xs-block">
    <div class="visible-xs-block">                            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".collapse">
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                            </button>
</div>
   </div>
   <div class="clearfix visible-xs-block"></div>
   <div class="col-xs-12 col-sm-2 nav-col collapse col-sm-height" style="visibility: visible;">
    <ul class="list-unstyled">
     <li>/ <a href="/about"> About</a></li>
     <li>/ <a href="/posts"> Archive</a></li>
     <li>/ <a href="/tags"> Tags</a></li>
     <li>/ <a href="/likes"> Likes</a></li>
    </ul>                        <a class="twitter-follow-button" href="https://twitter.com/daveaglick" data-show-count="false" data-lang="en">Follow @daveaglick</a>

   </div>
   <div class="clearfix visible-xs-block"></div>
   <div class="col-xs-12 col-sm-4 proj-col collapse col-sm-height" style="visibility: visible;">
    <div>Projects</div>
    <ul class="list-unstyled">
     <li>/ <a href="http://wyam.io">Wyam</a></li>
     <li>/ <a href="http://fluentbootstrap.com">FluentBootstrap</a></li>
     <li>/ <a href="https://github.com/daveaglick/LINQPad.CodeAnalysis">LINQPad.CodeAnalysis</a></li>
     <li>/ <a href="/razordatabase">RazorDatabase</a></li>
    </ul>
   </div>
  </div>
 </div>
 <div id="body-content" class="container">
  <div class="row">
   <div class="col-md-12">



<div class="banner container-sm-height">
 <div class="row row-sm-height">
  <div class="col-sm-8 col-sm-height col-bottom">            <div class="title">How to Post Data (Including Checkboxes) in a KendoUI Grid back to an ASP.NET MVC Action</div>
</div>
  <div class="col-sm-4 col-sm-height col-bottom stats">
   <div class="row">
    <div class="col-sm-12">                    <hr class="visible-xs-block" />
                        <div><strong>Tags</strong></div>
                        <div>

     <a role="button" href="/tags/asp.net" class="btn btn-default btn-sm tag-button icon-tag-2"> ASP.NET</a>
     <a role="button" href="/tags/asp.net-mvc" class="btn btn-default btn-sm tag-button icon-tag-2"> ASP.NET MVC</a>
     <a role="button" href="/tags/checkbox" class="btn btn-default btn-sm tag-button icon-tag-2"> checkbox</a>
     <a role="button" href="/tags/grid" class="btn btn-default btn-sm tag-button icon-tag-2"> grid</a>
     <a role="button" href="/tags/kendoui" class="btn btn-default btn-sm tag-button icon-tag-2"> KendoUI</a>
     <a role="button" href="/tags/kendoui-mvc" class="btn btn-default btn-sm tag-button icon-tag-2"> KendoUI MVC</a>
     <a role="button" href="/tags/postback" class="btn btn-default btn-sm tag-button icon-tag-2"> postback</a>                        </div>     
                        <div><strong>Published</strong></div>
                        <div class="icon-calendar"> &nbsp;Friday, January 3, 2014</div>
                    <div><strong>Comments</strong></div>
                    <div class="icon-talk-chat-2"> &nbsp;<a href="#disqus_thread" data-disqus-identifier="how-to-post-data-in-a-kendoui-grid"></a></div>               
                    <div><a class="twitter-share-button" href="https://twitter.com/share" data-url="http://www.daveaglick.com/posts/how-to-post-data-in-a-kendoui-grid" data-via="daveaglick" data-text="How to Post Data (Including Checkboxes) in a KendoUI Grid back to an ASP.NET MVC Action" data-count="none">Tweet</a></div>

    </div>
   </div>
  </div>
 </div>
</div>
<hr />

<div class="row">
 <div id="post-content" class="col-sm-12">
<p>The KendoUI grid is great for displaying data and manipulating it one row at a time. There are several options available including posting the edited data back via AJAX, performing in-line editing, etc. However, there is no built-in support for posting the grid data on form submission because the grid isn't an actual form control. This came up recently when designing a feature for an enterprise contact list. I had a view that should allow the user to select two contacts and merge them into one. The user needed to be able to select which addresses, phone numbers, etc. from both contact should be kept in the merged contact. A grid seemed like a perfect interface match since it supports multiple columns and I could (presumably) add a checkbox to the first (or last) one for the user to select. This turned out to be much more complicated than I had anticipated and there isn't a lot of help out there, so I'll walk you through the process.</p>

<h1>The Model</h1>

<p>My model is simple:</p>

<pre class="prettyprint">public class ContactInfoGridItem
{
    public string ContactInfoId { get; set; }
    public bool Keep { get; set; }
    public string Contact { get; set; }
    public string Type { get; set; }
    public string Content { get; set; }
}</pre>

<p>The important fields are <code>ContactInfoId</code> and <code>Keep</code> – <code>Contact</code>, <code>Type</code>, and <code>Content</code> are just bits of domain data for display to the user but won't be posted back on submit (they'll get default values after model binding).</p>

<h1>The Action</h1>

<p>This is the action we eventually want to receive the data:</p>

<pre class="prettyprint">public virtual ActionResult Index(IEnumerable&lt;ContactInfoGridItem&gt; contactInfo)
{
    //...
}</pre>

<p>We want the grid to send us a collection of <code>ContactInfoGridItems</code>. In my collection I only need the <code>ContactInfoId</code> and <code>Keep</code> fields to be set.</p>

<h1>The View</h1>

<p>The grid is declared like this (using KendoUI for ASP.NET MVC):</p>

<pre class="prettyprint">@(Html.Kendo().Grid(new List&lt;ContactInfoGridItem&gt;())
    .Name("grid")
    .DataSource(d =&gt; d.Ajax()
        .Read(r =&gt; r.Action(MVC.ContactList.Merge.ContactInfoGridRead()))
        .ServerOperation(false))
    .Columns(c =&gt;
    {
        c.Bound(m =&gt; m.ContactInfoId).Hidden()
            .ClientTemplate("&lt;input type='hidden' "
                + "name='contactInfo[#= gridIndex(data) #].ContactInfoId' "
                + "value='#= ContactInfoId #' /&gt;");
        c.Bound(m =&gt; m.Keep)
            .ClientTemplate("&lt;input type='checkbox' "
                + "name='contactInfo[#= gridIndex(data) #].Keep' "
                + "value='true' "
                + "#if (Keep) { #checked='checked'# } #/&gt;"
                + "&lt;input type='hidden' value='false' "
                + "name='contactInfo[#= gridIndex(data) #].Keep' /&gt;");
        c.Bound(m =&gt; m.Contact);
        c.Bound(m =&gt; m.Type);
        c.Bound(m =&gt; m.Content);
    }))</pre>

<p>So what's going on here? Don't worry about the Action – if you've never seen this syntax before, I'm just using <a href="http://t4mvc.codeplex.com/">T4MVC</a> (which I love) to eliminate magic strings. The first important note is that I'm declaring <code>ServerOperation(false)</code> on the <code>DataSource</code>. This ensures that KendoUI properly sends the data back to the server. I found <a href="http://www.kendoui.com/code-library/mvc/grid/submit-form-containing-grid-along-with-other-input-elements.aspx">this example</a> very helpful in understanding how to rig up posting of grid data. Next, notice the client templates for the <code>ContactInfoId</code> and <code>Keep</code> columns. The general principle here is that if we stick form controls (even hidden ones) directly inside the grid then they will get posted to the server like any other form control. The trick to getting a grid to work though is knowing how to identify and name form controls in such a way that ASP.NET MVC understands how to turn them into a collection. This can be accomplished by adding brackets after the form control name with an index – see <a href="http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx/">this blog post</a> for more details.</p>

<p>What I've covered so far works great for posting back form controls such as combo boxes and text entries as well as posting back hidden form controls with the initial data for a row and column. However, there is one more trick we need to use to get checkboxes to post successfully. The problem is that unlike other form controls, checkbox inputs do not post their data in the same way. Checking a checkbox does not actually change it's value. It took some digging to figure out how to get this to work, but I eventually stumbled upon <a href="http://stackoverflow.com/questions/14730746/getting-checkbox-value-in-asp-net-mvc-4">a very helpful Stack Overflow post</a>. It turns out that ASP.NET MVC and the default model binder use a little hack to get checkbox values bound on post. They create the checkbox with a value of true, but then also create a hidden input with the same name and a value of false. When a form is submitted, the model binder knows how to reconcile the two identically named form inputs to come up with the actual value of the checkbox based on it's checked state. We just need to use the same technique in our column client template and let the default model binder do it's thing.</p>

<p>Now when I post the form that contains this grid I'll get a collection of <code>ContactInfoGridItem</code> models with the correct <code>ContactInfoId</code> and <code>Keep</code> fields.</p></div>
</div>
<hr />

<div class="row">
 <div class="col-sm-12">        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'somedave'; // required: replace example with your forum shortname
            var disqus_identifier = 'how-to-post-data-in-a-kendoui-grid';
            var disqus_title = 'How to Post Data (Including Checkboxes) in a KendoUI Grid back to an ASP.NET MVC Action';
            var disqus_url = 'http://www.daveaglick.com/posts/how-to-post-data-in-a-kendoui-grid';

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>    
</div>
</div></div>
  </div>
 </div>
</div>        
<div id="sticky-footer-wrapper">
 <div id="sticky-footer">
  <div class="container">
   <small>                        
                            Copyright © 2015 by Dave Glick. All jams and jellies preserved. The opinions expressed herein are my own and do not represent those of my employer or any other third-party views in any way. This work is licensed under a
                            <a href="http://creativecommons.org/licenses/by/4.0/" rel="license">
    <span class="icon-creative-commons"></span> Creative Commons Attribution 4.0 International License</a>.
                            <br />
                            <a href="/feed.rss">
    <span class="icon-rss"></span> RSS Feed</a> | <a href="/feed.atom">
    <span class="icon-rss"></span> Atom Feed</a>
                            <br />
                            <a href="https://github.com/daveaglick/daveaglick">
    <span class="icon-github-square"></span> This Site on GitHub</a> | <strong><a href="http://wyam.io">Generated by Wyam</a></strong>
                        

   </small>
  </div>
 </div>
</div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'somedave'; // required: replace example with your forum shortname

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var s = document.createElement('script'); s.async = true;
                s.type = 'text/javascript';
                s.src = '//' + disqus_shortname + '.disqus.com/count.js';
                (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
            }());

            // Google Analytics
            (function (i, s, o, g, r, a, m) {
                i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                    (i[r].q = i[r].q || []).push(arguments)
                }, i[r].l = 1 * new Date(); a = s.createElement(o),
                m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
            })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

            ga('create', 'UA-54470483-1', 'auto');
            ga('send', 'pageview');

            // Twitter
            window.twttr = (function (d, s, id) {
                var t, js, fjs = d.getElementsByTagName(s)[0];
                if (d.getElementById(id)) return;
                js = d.createElement(s); js.id = id;
                js.src = "https://platform.twitter.com/widgets.js";
                fjs.parentNode.insertBefore(js, fjs);
                return window.twttr || (t = { _e: [], ready: function (f) { t._e.push(f) } });
            }(document, "script", "twitter-wjs"));

            // Background
            var colors = Please.make_color({
                golden: false,
                colors_returned: 3,
                saturation: .4
            });
            var t = new Trianglify({
                x_gradient: colors,
                y_gradient: ["#FFFFFF"]
            });
            var pattern = t.generate(document.body.clientWidth, document.body.clientHeight);
            document.body.setAttribute('style', 'background-image: ' + pattern.dataUrl);
        </script>
	</bodyonload="prettyPrint()">
</html>

